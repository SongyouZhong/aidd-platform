# =============================================================================
# AIDD Platform 配置文件
# =============================================================================

# -----------------------------------------------------------------------------
# 应用配置
# -----------------------------------------------------------------------------
app:
  name: aidd-platform
  version: 1.0.0
  env: ${APP_ENV:development}
  debug: ${APP_DEBUG:true}

# -----------------------------------------------------------------------------
# 服务器配置
# -----------------------------------------------------------------------------
server:
  host: ${SERVER_HOST:0.0.0.0}
  port: ${SERVER_PORT:8000}
  workers: ${SERVER_WORKERS:4}

# -----------------------------------------------------------------------------
# 数据库配置 (PostgreSQL)
# -----------------------------------------------------------------------------
database:
  host: ${POSTGRES_HOST:10.18.85.10}
  port: ${POSTGRES_PORT:30684}
  user: ${POSTGRES_USER:appuser}
  password: ${POSTGRES_PASSWORD:strongpassword}
  database: ${POSTGRES_DB:aichemol}
  pool_size: ${POSTGRES_POOL_SIZE:10}

# -----------------------------------------------------------------------------
# Redis 配置
# -----------------------------------------------------------------------------
redis:
  host: ${REDIS_HOST:localhost}
  port: ${REDIS_PORT:6379}
  password: ${REDIS_PASSWORD:}
  db: ${REDIS_DB:0}
  
  # 队列前缀
  queue_prefix: aidd:tasks
  
  # 结果过期时间（秒）
  result_expire: 86400

# -----------------------------------------------------------------------------
# 调度器配置
# -----------------------------------------------------------------------------
scheduler:
  # 调度间隔（秒）
  dispatch_interval: 1
  
  # 单次调度最大任务数
  max_dispatch_batch: 100
  
  # 任务默认超时（秒）
  default_timeout: 3600
  
  # 最大重试次数
  max_retries: 3
  
  # 重试延迟（秒）
  retry_delay: 60

# -----------------------------------------------------------------------------
# Worker 管理配置
# -----------------------------------------------------------------------------
worker_manager:
  # 心跳超时（秒），超过此时间未收到心跳视为离线
  heartbeat_timeout: 30
  
  # 心跳检查间隔（秒）
  heartbeat_check_interval: 10
  
  # Worker 离线后任务重新调度延迟（秒）
  reschedule_delay: 5

# -----------------------------------------------------------------------------
# 对象存储配置 (MinIO) - 用于文件传输
# -----------------------------------------------------------------------------
storage:
  minio:
    endpoint: ${MINIO_ENDPOINT:172.19.80.100:9090}
    access_key: ${MINIO_ACCESS_KEY:minioadmin}
    secret_key: ${MINIO_SECRET_KEY:minioadmin}
    secure: false
    bucket: ${MINIO_BUCKET:aidd-files}

# -----------------------------------------------------------------------------
# 服务队列映射
# 定义每种计算服务对应的 Redis 队列
# -----------------------------------------------------------------------------
service_queues:
  admet: aidd:tasks:admet
  docking: aidd:tasks:docking
  md: aidd:tasks:md
  qsar: aidd:tasks:qsar
